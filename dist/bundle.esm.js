import{createRenderer as e,combineRules as t}from"fela";import{renderToMarkup as r,rehydrate as n,render as o}from"fela-dom";import u from"fela-plugin-embedded";import i from"fela-plugin-prefixer";import c from"fela-plugin-fallback-value";import f from"fela-plugin-unit";import{when as a,complement as p,isNil as s,replace as l,last as h,compose as d,forEach as g,always as m,identity as y}from"ramda";var b=function(){return(b=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var v,w,O,j,x,P,$,k=function(e){return e.replace(/-(\w)/gu,function(e,t){return t.toUpperCase()})},S=function(e){var t,r=!1;return function(){return r?t:(r=!0,t=e())}},I=(v=/url\(.*?\)/g,w=/[,:;]/g,function(e){return e.replace(v,function(e){return e.replace(w,function(e){return"\\"+e})})}),N=a(p(s),l(/([^\\])\\([^\\])/g,"$1$2")),z=function(e,t){return e.reduce(function(e,r,n){return e+r+(t[n]||"")},"")},E=function(){function e(){this.o={},this.path=[],this.path.push([this.o])}return Object.defineProperty(e.prototype,"out",{get:function(){return this.o},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.path.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){for(var t=h(this.path),r=[],n=0,o=e;n<o.length;n++)for(var u=o[n],i=0,c=t;i<c.length;i++){var f=c[i];f[u]||(f[u]={}),r.push(f[u])}this.path.push(r)},e.prototype.merge=function(e,t){if(t&&e)for(var r=0,n=h(this.path);r<n.length;r++){n[r][e]=t}},e.prototype.pop=function(){return this.path.pop()},e}(),C=(O=/^([\w-]+)(: *| +)(.*)$/,j=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,x=/\s*,\s*/g,P=/(.*):$/,function(e,t,r){var n;switch(!0){case"{"==t:e.add(r);break;case"}"==t:e.pop();break;case null!=(n=O.exec(t)):e.merge(N(k(n[1])),a(isNaN,N,function(e){switch(e){case"undefined":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}}(n[3])));break;case null!=(n=j.exec(t)):r.splice(0),r.push.apply(r,t.split(x).map(function(t){return"."==(t=t.replace(P,"$1"))[0]&&(t=e.depth>1?"& "+t:t.slice(1)),t}))}}),R=function(){var e=["\n","\r",";"],t=function(t){return e.includes(t)},r=new RegExp("(?!\\\\)("+e.join("|")+")","g"),n=/((^\s*?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm;return function(e){var o,u,i=new E,c=[];return d(function(){return i.out},g(function(e){if((e=e.trim())&&C(i,e,c),i.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")}),(o=r,u=1,function(e){for(var t,r,n=o.lastIndex,i=0,c=[];null!==(t=o.exec(e));)r=t[u]||"",c.push(e.slice(i,o.lastIndex-r.length)),i=o.lastIndex;return i<e.length&&c.push(e.slice(i)),o.lastIndex=n,c}),l(/(\{|\})/g,function(e,r,n,o){return t(o[n-1])||(r=";"+r),t(o[n+1])||(r+=";"),r}),I,l(n,""))(e)}}(),_=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return R(z(e,t))},U=Object.freeze({}),q=function(){try{return"object"==typeof window}catch(e){return!1}}(),A={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},B=Object.freeze({f:"function",o:"object",s:"string"}),D=($=function(e,t){return e[t]||e[k(t)]},function(e,t,r){switch(t||(t=U),typeof r){case B.f:return[r];case B.o:return[m(r)];case B.s:return function(e,t,r){return r.split(/[,\s\t]+/g).map(function(r){return $(t,r)||$(e(),r)||U})}(e,t,r).reduce(function(r,n){return r.push.apply(r,D(e,t,n)),r},[]);default:return[y]}}),F=function(){function a(r){var a,p,s,l;void 0===r&&(r={});var h=b({},A,r),d=h.method,g=h.ssr,m=h.preset,y=h.plugins,v=h.enhancers,w=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}(h,["method","ssr","preset","plugins","enhancers"]),O=b({},A.preset,m||{});if(r.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(b({},w,{enhancers:v,plugins:[u(),i(),c(),f.apply(void 0,O.unit)].concat(y)}));var j,x,P=this.renderer,$=r.defStyles;switch(typeof $){case B.o:j=(a=[$.key,$.value])[0],x=a[1];break;case B.f:j=(p=["fdef",$])[0],x=p[1]}q&&(g?n(P):o(P)),this._mixin={methods:(s={},s[d]=function(e,r){var n=this;return void 0===r&&(r={}),P.renderRule(t.apply(void 0,D(S(function(){return x?x(n):U}),this.style,e)),r)||void 0},s),computed:$?(l={},l[j]=function(){return x(this)},l):{}}}return Object.defineProperty(a.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"style",{get:function(){return r(this.renderer)},enumerable:!0,configurable:!0}),a}();export{F as Renderer,_ as css};
