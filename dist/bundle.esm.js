import{createRenderer as e,combineRules as r}from"fela";import{renderToMarkup as t,rehydrate as n,render as o}from"fela-dom";import i from"fela-plugin-embedded";import u from"fela-plugin-prefixer";import c from"fela-plugin-fallback-value";import f from"fela-plugin-unit";import{when as a,complement as s,isNil as l,replace as p,both as h,isEmpty as d,compose as m,equals as g,type as y,map as b,length as v,last as O,forEach as w,identity as j,always as x}from"ramda";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var P=function(){return(P=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};function N(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),o=0;for(r=0;r<t;r++)for(var i=arguments[r],u=0,c=i.length;u<c;u++,o++)n[o]=i[u];return n}var $,k,z,S,_,E,C,A,I,R,U=function(e){return e.replace(/-(\w)/gu,(function(e,r){return r.toUpperCase()}))},q=function(e){var r,t=!1;return function(){return t?r:(t=!0,r=e())}},B=($=/url\(.*?\)/g,k=/[,:;]/g,function(e){return e.replace($,(function(e){return e.replace(k,(function(e){return"\\"+e}))}))}),D=a(s(l),p(/([^\\])\\([^\\])/g,"$1$2")),F=h(s(d),s(l)),G=function(e,r){return e.reduce((function(e,t,n){return e+t+r[n]}),"")},H=m(g("Object"),y),J=function(e,r){for(var t in r)H(e[t])&&H(r[t])?J(e[t],r[t]):e[t]=r[t];return e},K=function(){function e(e){this.rules={};var r=e.match(/\.[\w-_]+/);this.s={className:r?r[0].slice(1):null,modifier:r?e.slice(r[0].length)||null:e}}return Object.defineProperty(e.prototype,"complex",{get:function(){return null!==this.s.className&&null!==this.s.modifier},enumerable:!0,configurable:!0}),e.prototype.serialize=function(){var e=this.s,r=e.className;return(r?"."+r:"")+(e.modifier||"")},e}(),L=function(e,r){var t;void 0===r&&(r=0);var n,o,i,u,c,f={};for(c in e.rules)(n=e.rules[c])instanceof K?(o=n.complex?n.s.className:n.serialize(),i=0==r&&"."==o[0]?o.slice(1):"."==o[0]?"& "+o:o,u=n.complex?((t={})[n.s.modifier]=L(n,r+1),t):L(n,r+1),f[i]?J(f[i],u):f[i]=u):f[c]=n;return f},M=function(){function e(){this.path=[],this.path.push([new K("__root")])}return Object.defineProperty(e.prototype,"out",{get:function(){return L(this.path[0][0])},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.path.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){for(var r=O(this.path),t=[],n=0,o=e;n<o.length;n++)for(var i=o[n],u=new K(i),c=0,f=r;c<f.length;c++){var a=f[c],s=u.serialize(),l=a.rules[s];t.push(l||u),l||(a.rules[s]=u)}this.path.push(t)},e.prototype.merge=function(e,r){if(F(r)&&F(e))for(var t=0,n=O(this.path);t<n.length;t++){n[t].rules[e]=r}},e.prototype.pop=function(){return this.path.pop()},e}(),Q=(z=/^([\w-]+)(: *| +)(.*)$/,S=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,_=/\s*,\s*/g,E=/(.*):$/,function(e,r,t){var n;switch(!0){case"{"==r:e.add(t);break;case"}"==r:e.pop();break;case null!=(n=z.exec(r)):e.merge(D(U(n[1])),a(isNaN,D,function(e){switch(e){case"undefined":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}}(n[3])));break;case null!=(n=S.exec(r)):t.splice(0),t.push.apply(t,r.split(_).map((function(e){return e.replace(E,"$1")})))}}),T=(C=["\n","\r",";"],A=function(e){return C.includes(e)},I=/(([\s^]+?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm,function(e){var r,t=new M,n=[];return m((function(){return t.out}),w((function(e){if((e=e.trim())&&Q(t,e,n),t.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")})),(r=C,function(e){var t,n,o=b(v,r),i=[],u=0,c=r.length,f=e.length;for(t=0;t<f;t++)for(n=0;n<c;n++)e.slice(t,t+o[n])===r[n]&&"\\"!==e[t-1]&&(i.push(e.slice(u,t)),u=(t+=o[n]-1)+1);return u!==e.length-1&&i.push(e.slice(u)),i}),p(/(\{|\})/g,(function(e,r,t,n){return A(n[t-1])||(r=";"+r),A(n[t+1])||(r+=";"),r})),B,p(I,""))(e)}),V=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return T(G(e,r))},W=Object.freeze({}),X=function(){try{return"object"==typeof window}catch(e){return!1}}(),Y={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},Z=Object.freeze({f:"function",o:"object",s:"string"}),ee=(R=function(e,r){return e[r]||e[U(r)]},function(e,r,t){switch(r||(r=W),typeof t){case Z.f:return[t];case Z.o:return[x(t)];case Z.s:return function(e,r,t){return t.split(/[,\s\t]+/g).map((function(t){return R(r,t)||R(e(),t)||W}))}(e,r,t).reduce((function(t,n){return t.push.apply(t,ee(e,r,n)),t}),[]);default:return[j]}}),re=function(){function a(t){var a,s,l,p;void 0===t&&(t={});var h=P(P({},Y),t),d=h.method,m=h.ssr,g=h.preset,y=h.plugins,b=h.enhancers,v=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t}(h,["method","ssr","preset","plugins","enhancers"]),O=P(P({},Y.preset),g||{});if(t.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(P(P({},v),{enhancers:b,plugins:N([i(),u(),c(),f.apply(void 0,O.unit)],y)}));var w,j,x=this.renderer,$=t.defStyles;switch(typeof $){case Z.o:w=(a=[$.key,$.value])[0],j=a[1];break;case Z.f:w=(s=["fdef",$])[0],j=s[1]}X&&(m?n(x):o(x)),this._mixin={methods:(l={},l[d]=function(e,t){var n=this;return void 0===t&&(t={}),x.renderRule(r.apply(void 0,ee(q((function(){return j?j(n):W})),this.style,e)),t)||void 0},l),computed:$?(p={},p[w]=function(){return j(this)},p):{}}}return Object.defineProperty(a.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"style",{get:function(){return t(this.renderer)},enumerable:!0,configurable:!0}),a}();export{re as Renderer,V as css};
