import{createRenderer as e,combineRules as r}from"fela";import{renderToMarkup as t,rehydrate as n,render as o}from"fela-dom";import u from"fela-plugin-embedded";import i from"fela-plugin-prefixer";import c from"fela-plugin-fallback-value";import f from"fela-plugin-unit";import{when as a,complement as p,isNil as s,replace as l,both as h,isEmpty as d,map as g,length as m,last as y,compose as b,forEach as v,always as O,identity as w}from"ramda";var j=function(){return(j=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};var x,P,$,k,S,N,z,C,E,_,R=function(e){return e.replace(/-(\w)/gu,function(e,r){return r.toUpperCase()})},U=function(e){var r,t=!1;return function(){return t?r:(t=!0,r=e())}},q=(x=/url\(.*?\)/g,P=/[,:;]/g,function(e){return e.replace(x,function(e){return e.replace(P,function(e){return"\\"+e})})}),A=a(p(s),l(/([^\\])\\([^\\])/g,"$1$2")),B=h(p(d),p(s)),D=function(e,r){return e.reduce(function(e,t,n){return e+t+(r[n]||"")},"")},F=function(){function e(){this.o={},this.path=[],this.path.push([this.o])}return Object.defineProperty(e.prototype,"out",{get:function(){return this.o},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.path.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){for(var r=y(this.path),t=[],n=0,o=e;n<o.length;n++)for(var u=o[n],i=0,c=r;i<c.length;i++){var f=c[i];f[u]||(f[u]={}),t.push(f[u])}this.path.push(t)},e.prototype.merge=function(e,r){if(B(r)&&B(e))for(var t=0,n=y(this.path);t<n.length;t++){n[t][e]=r}},e.prototype.pop=function(){return this.path.pop()},e}(),G=($=/^([\w-]+)(: *| +)(.*)$/,k=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,S=/\s*,\s*/g,N=/(.*):$/,function(e,r,t){var n;switch(!0){case"{"==r:e.add(t);break;case"}"==r:e.pop();break;case null!=(n=$.exec(r)):e.merge(A(R(n[1])),a(isNaN,A,function(e){switch(e){case"undefined":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}}(n[3])));break;case null!=(n=k.exec(r)):t.splice(0),t.push.apply(t,r.split(S).map(function(r){return"."==(r=r.replace(N,"$1"))[0]&&(r=e.depth>1?"& "+r:r.slice(1)),r}))}}),H=(z=["\n","\r",";"],C=function(e){return z.includes(e)},E=/((^\s*?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm,function(e){var r,t=new F,n=[];return b(function(){return t.out},v(function(e){if((e=e.trim())&&G(t,e,n),t.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")}),(r=z,function(e){var t,n,o=g(m,r),u=[],i=0,c=r.length,f=e.length;for(t=0;t<f;t++)for(n=0;n<c;n++)e.slice(t,t+o[n])===r[n]&&"\\"!==e[t-1]&&(u.push(e.slice(i,t)),i=(t+=o[n]-1)+1);return i!==e.length-1&&u.push(e.slice(i)),u}),l(/(\{|\})/g,function(e,r,t,n){return C(n[t-1])||(r=";"+r),C(n[t+1])||(r+=";"),r}),q,l(E,""))(e)}),I=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return H(D(e,r))},J=Object.freeze({}),K=function(){try{return"object"==typeof window}catch(e){return!1}}(),L={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},M=Object.freeze({f:"function",o:"object",s:"string"}),Q=(_=function(e,r){return e[r]||e[R(r)]},function(e,r,t){switch(r||(r=J),typeof t){case M.f:return[t];case M.o:return[O(t)];case M.s:return function(e,r,t){return t.split(/[,\s\t]+/g).map(function(t){return _(r,t)||_(e(),t)||J})}(e,r,t).reduce(function(t,n){return t.push.apply(t,Q(e,r,n)),t},[]);default:return[w]}}),T=function(){function a(t){var a,p,s,l;void 0===t&&(t={});var h=j({},L,t),d=h.method,g=h.ssr,m=h.preset,y=h.plugins,b=h.enhancers,v=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)r.indexOf(n[o])<0&&(t[n[o]]=e[n[o]])}return t}(h,["method","ssr","preset","plugins","enhancers"]),O=j({},L.preset,m||{});if(t.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(j({},v,{enhancers:b,plugins:[u(),i(),c(),f.apply(void 0,O.unit)].concat(y)}));var w,x,P=this.renderer,$=t.defStyles;switch(typeof $){case M.o:w=(a=[$.key,$.value])[0],x=a[1];break;case M.f:w=(p=["fdef",$])[0],x=p[1]}K&&(g?n(P):o(P)),this._mixin={methods:(s={},s[d]=function(e,t){var n=this;return void 0===t&&(t={}),P.renderRule(r.apply(void 0,Q(U(function(){return x?x(n):J}),this.style,e)),t)||void 0},s),computed:$?(l={},l[w]=function(){return x(this)},l):{}}}return Object.defineProperty(a.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"style",{get:function(){return t(this.renderer)},enumerable:!0,configurable:!0}),a}();export{T as Renderer,I as css};
