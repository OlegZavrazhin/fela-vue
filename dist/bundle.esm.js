import{createRenderer as e,combineRules as r}from"fela";import{renderToMarkup as t,rehydrate as n,render as o}from"fela-dom";import u from"fela-plugin-embedded";import i from"fela-plugin-prefixer";import c from"fela-plugin-fallback-value";import f from"fela-plugin-unit";import{when as a,complement as p,isNil as s,replace as l,map as h,length as d,last as g,compose as m,forEach as y,always as b,identity as v}from"ramda";var O=function(){return(O=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)};var w,j,x,P,$,k,S,N,z,C,E=function(e){return e.replace(/-(\w)/gu,function(e,r){return r.toUpperCase()})},_=function(e){var r,t=!1;return function(){return t?r:(t=!0,r=e())}},R=(w=/url\(.*?\)/g,j=/[,:;]/g,function(e){return e.replace(w,function(e){return e.replace(j,function(e){return"\\"+e})})}),U=a(p(s),l(/([^\\])\\([^\\])/g,"$1$2")),q=function(e,r){return e.reduce(function(e,t,n){return e+t+(r[n]||"")},"")},A=function(){function e(){this.o={},this.path=[],this.path.push([this.o])}return Object.defineProperty(e.prototype,"out",{get:function(){return this.o},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.path.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){for(var r=g(this.path),t=[],n=0,o=e;n<o.length;n++)for(var u=o[n],i=0,c=r;i<c.length;i++){var f=c[i];f[u]||(f[u]={}),t.push(f[u])}this.path.push(t)},e.prototype.merge=function(e,r){if(r&&e)for(var t=0,n=g(this.path);t<n.length;t++){n[t][e]=r}},e.prototype.pop=function(){return this.path.pop()},e}(),B=(x=/^([\w-]+)(: *| +)(.*)$/,P=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,$=/\s*,\s*/g,k=/(.*):$/,function(e,r,t){var n;switch(!0){case"{"==r:e.add(t);break;case"}"==r:e.pop();break;case null!=(n=x.exec(r)):e.merge(U(E(n[1])),a(isNaN,U,function(e){switch(e){case"undefined":case"":return;case"null":return null;default:return isNaN(+e)?e:+e}}(n[3])));break;case null!=(n=P.exec(r)):t.splice(0),t.push.apply(t,r.split($).map(function(r){return"."==(r=r.replace(k,"$1"))[0]&&(r=e.depth>1?"& "+r:r.slice(1)),r}))}}),D=(S=["\n","\r",";"],N=function(e){return S.includes(e)},z=/((^\s*?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm,function(e){var r,t=new A,n=[];return m(function(){return t.out},y(function(e){if((e=e.trim())&&B(t,e,n),t.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")}),(r=S,function(e){var t,n,o=h(d,r),u=[],i=0,c=r.length,f=e.length;for(t=0;t<f;t++)for(n=0;n<c;n++)e.slice(t,t+o[n])===r[n]&&"\\"!==e[t-1]&&(u.push(e.slice(i,t)),i=(t+=o[n]-1)+1);return i!==e.length-1&&u.push(e.slice(i)),u}),l(/(\{|\})/g,function(e,r,t,n){return N(n[t-1])||(r=";"+r),N(n[t+1])||(r+=";"),r}),R,l(z,""))(e)}),F=function(e){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return D(q(e,r))},G=Object.freeze({}),H=function(){try{return"object"==typeof window}catch(e){return!1}}(),I={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},J=Object.freeze({f:"function",o:"object",s:"string"}),K=(C=function(e,r){return e[r]||e[E(r)]},function(e,r,t){switch(r||(r=G),typeof t){case J.f:return[t];case J.o:return[b(t)];case J.s:return function(e,r,t){return t.split(/[,\s\t]+/g).map(function(t){return C(r,t)||C(e(),t)||G})}(e,r,t).reduce(function(t,n){return t.push.apply(t,K(e,r,n)),t},[]);default:return[v]}}),L=function(){function a(t){var a,p,s,l;void 0===t&&(t={});var h=O({},I,t),d=h.method,g=h.ssr,m=h.preset,y=h.plugins,b=h.enhancers,v=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)r.indexOf(n[o])<0&&(t[n[o]]=e[n[o]])}return t}(h,["method","ssr","preset","plugins","enhancers"]),w=O({},I.preset,m||{});if(t.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(O({},v,{enhancers:b,plugins:[u(),i(),c(),f.apply(void 0,w.unit)].concat(y)}));var j,x,P=this.renderer,$=t.defStyles;switch(typeof $){case J.o:j=(a=[$.key,$.value])[0],x=a[1];break;case J.f:j=(p=["fdef",$])[0],x=p[1]}H&&(g?n(P):o(P)),this._mixin={methods:(s={},s[d]=function(e,t){var n=this;return void 0===t&&(t={}),P.renderRule(r.apply(void 0,K(_(function(){return x?x(n):G}),this.style,e)),t)||void 0},s),computed:$?(l={},l[j]=function(){return x(this)},l):{}}}return Object.defineProperty(a.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"style",{get:function(){return t(this.renderer)},enumerable:!0,configurable:!0}),a}();export{L as Renderer,F as css};
