import{createRenderer as e,combineRules as t}from"fela";import{renderToMarkup as r,rehydrate as n,render as o}from"fela-dom";import i from"fela-plugin-embedded";import u from"fela-plugin-prefixer";import c from"fela-plugin-fallback-value";import f from"fela-plugin-unit";var p=function(){return(p=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var a,s,l,h,d,g=function(e){return e},y=function(e){return e.replace(/-(\w)/gu,function(e,t){return t.toUpperCase()})},m=function(e){return e[e.length-1]},b=function(e){var t,r=!1;return function(){return r?t:(r=!0,t=e())}},v=function(){function e(){this.o={},this.path=[],this.path.push([this.o])}return Object.defineProperty(e.prototype,"out",{get:function(){return this.o},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this.path.length},enumerable:!0,configurable:!0}),e.prototype.add=function(e){for(var t=m(this.path),r=[],n=0,o=e;n<o.length;n++)for(var i=o[n],u=0,c=t;u<c.length;u++){var f=c[u];f[i]||(f[i]={}),r.push(f[i])}this.path.push(r)},e.prototype.merge=function(e,t){for(var r=0,n=m(this.path);r<n.length;r++){n[r][e]=t}},e.prototype.pop=function(){return this.path.pop()},e}(),O=(a=/^([\w-]+)(: *| +)(.*)$/,s=/^(([\|~\$@>\*\.:&\(\)\^="\-\[\]]+).*[ ,]*)+:?$/,l=/\s*,\s*/g,h=/(.*):$/,function(e,t,r){var n;switch(!0){case"{"==t:e.add(r);break;case"}"==t:e.pop();break;case null!=(n=a.exec(t)):e.merge(y(n[1]),isNaN(n[3])?n[3]:+n[3]);break;case null!=(n=s.exec(t)):r.splice(0),r.push.apply(r,t.split(l).map(function(t){return"."==(t=t.replace(h,"$1"))[0]&&(t=e.depth>1?"& "+t:t.slice(1)),t}))}}),w=function(){var e=["\n","\r",";"],t=function(t){return e.includes(t)},r=new RegExp("["+e.join("")+"]","g"),n=/((^\s*?\/\/.*$)|\/\*(.|[\n\r])*?\*\/)/gm;return function(e){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var u=[],c=new v;return function(e,t){return e.reduce(function(e,r,n){return e+r+(null==t[n]?"":t[n])},"")}(e,o).replace(n,"").replace(/(\{|\})/g,function(e,r,n,o){return t(o[n-1])||(r=";"+r),t(o[n+1])||(r+=";"),r}).split(r).forEach(function(e){if((e=e.trim())&&O(c,e,u),c.depth<1)throw new Error("lit-css parse error: unbalanced {} braces !")}),c.out}}(),j=Object.freeze({}),x=function(){try{return"object"==typeof window}catch(e){return!1}}(),P={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},k=Object.freeze({f:"function",o:"object",s:"string"}),$=(d=function(e,t){return e[t]||e[y(t)]},function(e,t,r){switch(t||(t=j),typeof r){case k.f:return[r];case k.o:return[(n=r,function(){return n})];case k.s:return function(e,t,r){return r.split(/[,\s\t]+/g).map(function(r){return d(t,r)||d(e(),r)||j})}(e,t,r).reduce(function(r,n){return r.push.apply(r,$(e,t,n)),r},[]);default:return[g]}var n}),S=function(){function a(r){var a,s,l,h;void 0===r&&(r={});var d=p({},P,r),g=d.method,y=d.ssr,m=d.preset,v=d.plugins,O=d.enhancers,w=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&(r[n[o]]=e[n[o]])}return r}(d,["method","ssr","preset","plugins","enhancers"]),S=p({},P.preset,m||{});if(r.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=e(p({},w,{enhancers:O,plugins:[i(),u(),c(),f.apply(void 0,S.unit)].concat(v)}));var E,z,C=this.renderer,N=r.defStyles;switch(typeof N){case k.o:E=(a=[N.key,N.value])[0],z=a[1];break;case k.f:E=(s=["fdef",N])[0],z=s[1]}x&&(y?n(C):o(C)),this._mixin={methods:(l={},l[g]=function(e,r){var n=this;return void 0===r&&(r={}),C.renderRule(t.apply(void 0,$(b(function(){return z?z(n):j}),this.style,e)),r)||void 0},l),computed:N?(h={},h[E]=function(){return z(this)},h):{}}}return Object.defineProperty(a.prototype,"mixin",{get:function(){return Object.freeze(this._mixin)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"style",{get:function(){return r(this.renderer)},enumerable:!0,configurable:!0}),a}();export{S as Renderer,w as css};
