"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var fela=require("fela"),felaDom=require("fela-dom"),embedded=_interopDefault(require("fela-plugin-embedded")),prefixer=_interopDefault(require("fela-plugin-prefixer")),fallback=_interopDefault(require("fela-plugin-fallback-value")),unit=_interopDefault(require("fela-plugin-unit"));const isObject=e=>"object"==typeof e,isBrowser=(()=>{try{return isObject(window)}catch(e){return!1}})(),defaultOpts={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},getRules=(()=>{const e=e=>()=>e,r=e=>e,t="function",n="object",s="string";return(u,i)=>{switch(typeof i){case t:return[i];case n:return[e(i)];case s:return((e,r)=>r.split(/[,\s\t]+/g).map(r=>((e,r)=>e?e[r]||e[(e=>e.replace(/-(\w)/gu,(e,r)=>r.toUpperCase()))(r)]:{})(e,r)))(u,i).reduce((e,r)=>(e.push(...getRules(u,r)),e),[]);default:return[r]}}})();class Renderer{get mixin(){return Object.freeze(this._mixin)}get style(){return felaDom.renderToMarkup(this.renderer)}constructor(e={}){const{method:r,ssr:t,preset:n,plugins:s,enhancers:u}=Object.assign({},defaultOpts,e),i=Object.assign({},defaultOpts.preset,n||{});if(e.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=fela.createRenderer({enhancers:u,plugins:[embedded(),prefixer(),fallback(),unit(...i.unit),...s]});const{renderer:l}=this,a=e.defStyles;let f,o;a&&([f,o]={object:[a.key,a.value],function:["fdef",a]}[typeof a]),isBrowser&&(t?felaDom.rehydrate(l):felaDom.render(l)),this._mixin={methods:{[r](e,r={}){return l.renderRule(fela.combineRules(...getRules(this.style,e)),r)}},computed:a?{[f](){return o(this)}}:{}}}}exports.Renderer=Renderer;
