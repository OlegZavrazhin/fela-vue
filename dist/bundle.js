"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var fela=require("fela"),felaDom=require("fela-dom"),embedded=_interopDefault(require("fela-plugin-embedded")),prefixer=_interopDefault(require("fela-plugin-prefixer")),fallback=_interopDefault(require("fela-plugin-fallback-value")),unit=_interopDefault(require("fela-plugin-unit"));function __rest(e,r){var t={};for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&r.indexOf(s)<0&&(t[s]=e[s]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(s=Object.getOwnPropertySymbols(e);n<s.length;n++)r.indexOf(s[n])<0&&(t[s[n]]=e[s[n]])}return t}const always=e=>()=>e,reflect=e=>e,camelify=e=>e.replace(/-(\w)/gu,(e,r)=>r.toUpperCase()),join=(e,r)=>{const t=e.length;let s="";for(let n=0;n<t;n++)s+=e[n]+(null==r[n]?"":r[n]);return s},css=(()=>{const e=/(}|[^\n]*?\s*([\w-]+)[:\s]+(.*?))([\n;]|{|(?=})|$)/g;return(r,...t)=>{const s={};let n,l=s;return join(r,t).replace(e,(e,r,t,s,i,a,f)=>{if("{"==i)n=l,l[camelify(t)]=l={};else if("}"==r){if(!n)throw new Error("Bad rule: "+f);l=n,n=null}else l[camelify(t)]=isNaN(s)?s.trim():+s;return""}),s}})(),isObject=e=>"object"==typeof e,isBrowser=(()=>{try{return isObject(window)}catch(e){return!1}})(),defaultOpts={method:"f",defStyles:void 0,plugins:[],enhancers:[],preset:{unit:[]},ssr:!1},types=Object.freeze({f:"function",o:"object",s:"string"}),getRules=(()=>{const e=(e,r)=>r.split(/[,\s\t]+/g).map(r=>((e,r)=>e?e[r]||e[camelify(r)]:{})(e,r));return(r,t)=>{switch(typeof t){case types.f:return[t];case types.o:return[always(t)];case types.s:return e(r,t).reduce((e,t)=>(e.push(...getRules(r,t)),e),[]);default:return[reflect]}}})();class Renderer{get mixin(){return Object.freeze(this._mixin)}get style(){return felaDom.renderToMarkup(this.renderer)}constructor(e={}){const r=Object.assign({},defaultOpts,e),{method:t,ssr:s,preset:n,plugins:l,enhancers:i}=r,a=__rest(r,["method","ssr","preset","plugins","enhancers"]),f=Object.assign({},defaultOpts.preset,n||{});if(e.fdef)throw new Error("fela-vue: Change deprecated `fdef` to `defStyles`!");this.renderer=fela.createRenderer(Object.assign({},a,{enhancers:i,plugins:[embedded(),prefixer(),fallback(),unit(...f.unit),...l]}));const{renderer:u}=this,o=e.defStyles;let c,p;switch(typeof o){case types.o:[c,p]=[o.key,o.value];break;case types.f:[c,p]=["fdef",o]}isBrowser&&(s?felaDom.rehydrate(u):felaDom.render(u)),this._mixin={methods:{[t](e,r={}){return u.renderRule(fela.combineRules(...getRules(this.style,e)),r)}},computed:o?{[c](){return p(this)}}:{}}}}exports.Renderer=Renderer,exports.css=css;
